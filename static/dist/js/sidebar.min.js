$(function(){function o(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}$(".sidebar .top ul li").on("mouseenter",function(a){a.target.tagName,$(this).parent().find("a").removeClass("cur"),$(this).children("a").addClass("cur");var t=$(this).parents(".top").next(),i=0;switch(t.children().removeClass("hidden").hide(),$(this).attr("class")){case"first":t.children(".first").show(),i="18px";break;case"second":t.children(".second").show(),i="114px";break;case"last":t.children(".last").show(),i="210px"}$(this).parents(".top").children(".bar").animate({left:i},"fast")});function c(a,t,i){return""==a?a=isHttps?"https://secure.gravatar.com/avatar/"+md5(t)+"?s="+i:"http://gravatar.com/avatar/"+md5(t)+"?s="+i:0==a.indexOf("http")?a+="&s="+i:a=cdnDomain+"avatar/"+a+"?imageView2/2/w/"+i,a}emojify.setConfig({only_crawl_id:null,img_dir:SG.EMOJI_DOMAIN,ignored_tags:{SCRIPT:1,TEXTAREA:1,A:1,PRE:1,CODE:1}});var t=function(a,t){if(a.ok){a=a.data;var i="";for(var e in a){var s=c(a[e].avatar,a[e].email,48);i+='<li\tclass="pull-left"><div class="avatar"><a href="/user/'+a[e].username+'" title="'+a[e].username+'"><img alt="'+a[e].username+'" class="img-circle" src="'+s+'" width="24px" height="24px"></a></div><div class="name" style="white-space: nowrap;"><a style="word-break: normal;" href="/user/'+a[e].username+'" title="'+a[e].username+'">'+a[e].username+"</a></div></li>"}$(".sb-content "+t+" ul").html(i)}},a={"/topics/recent":{func:function(a){if(a.ok){a=a.data;var t="";for(var i in a){var e=o(a[i].title);t+='<li class="truncate"><i></i><a href="/topics/'+a[i].tid+'?fr=sidebar" title="'+e+'">'+e+"</a></li>"}$(".sb-content .topic-list ul").html(t)}},class:".topic-list"},"/articles/recent":{func:function(a){if(a.ok){a=a.data;var t="";for(var i in a){var e=o(a[i].title);t+='<li class="truncate"><i></i><a href="/articles/'+a[i].id+'?fr=sidebar" title="'+e+'">'+e+"</a></li>"}$(".sb-content .article-list ul").html(t)}},class:".article-list"},"/projects/recent":{func:function(a){if(a.ok){a=a.data;var t="";for(var i in a){var e=a[i].id;""!=a[i].uri&&(e=a[i].uri);var s=a[i].category+" "+a[i].name,n=a[i].logo;s=o(s),t+='<li><a href="/p/'+e+'"><div class="logo"><img src="'+n+'" alt="'+a[i].name+'" width="48px"/></div></a><div class="title"><h4><a href="/p/'+e+'?fr=sidebar" title="'+s+'">'+s+"</a></h4></div></li>"}$(".sb-content .project-list ul").html(t)}},class:".project-list"},"/resources/recent":{func:function(a){if(a.ok){a=a.data;var t="";for(var i in a){var e=o(a[i].title);t+='<li class="truncate"><i></i><a href="/resources/'+a[i].id+'?fr=sidebar" title="'+e+'">'+e+"</a></li>"}$(".sb-content .resource-list ul").html(t)}},class:".resource-list"},"/comments/recent":{func:function(a){if(a.ok){var t=(a=a.data).comments,i="";for(var e in t){var s=t[e].objinfo.uri+t[e].objid,n=a[t[e].uid],r=c(n.avatar,n.email,40),l=SG.timeago(t[e].ctime);if(l==t[e].ctime)l=l.split(" ")[0];i+='<li><div class="pic"><a href="/user/'+n.username+'" target="_blank"><img src="'+r+'" alt="'+n.username+'" width="40px" height="40px"></a></div><div class="word"><div class="w-name"><a href="/user/'+n.username+'" target="_blank" title="'+n.username+'">'+n.username+'</a><span title="'+t[e].ctime+'">'+l+'</span></div><div class="w-page"><span>在 <a href="'+s+'#commentForm" title="'+t[e].objinfo.title+'">'+t[e].objinfo.title+'</a> 中评论</span></div><div class="w-comment"><span>'+t[e].content+"</span></div></div></li>"}$(".sb-content .cmt-list ul").html(i),emojify.run($(".sb-content .cmt-list ul").get(0))}},class:".cmt-list"},"/users/active":{func:function(a){t(a,"#active-list")},class:"#active-list"},"/users/newest":{func:function(a){t(a,"#newest-list")},class:"#newest-list"},"/websites/stat":{func:function(a){if(a.ok){var t="<li>会员数: <span>"+(a=a.data).user+"</span> 人</li>";0<a.topic&&(t+="<li>主题数: <span>"+a.topic+"</span> 个</li>"),0<a.article&&(t+="<li>文章数: <span>"+a.article+"</span> 篇</li>"),0<a.comment&&(t+="<li>回复数: <span>"+a.comment+"</span> 条</li>"),0<a.resource&&(t+="<li>资源数: <span>"+a.resource+"</span> 个</li>"),0<a.project&&(t+="<li>项目数: <span>"+a.project+"</span> 个</li>"),0<a.book&&(t+="<li>图书数: <span>"+a.book+"</span> 本</li>"),$(".sb-content .stat-list ul").html(t)}},class:".stat-list"},"/readings/recent":{func:function(a){if(a.ok){if(!(a=a.data)||0==a.length)return void $(".sb-content .reading-list").parents(".sidebar").hide();var t="";if(1==a.length)t='<li><a href="/readings/'+(a=a[0]).id+'" target="_blank">'+a.content+"</a></li>";else for(var i in a)t+='<li><a href="/readings/'+a[i].id+'"><div class="time"><span>10-25</span></div></a><div class="title"><h4><a href="/readings/'+a[i].id+'">'+a[i].content+"</a></h4></div></li>";$(".sb-content .reading-list ul").html(t)}},class:".reading-list"},"/nodes/hot":{func:function(a){if(a.ok){if(null==(a=a.data))return;var t="";for(var i in a)t+='<li><a href="/go/'+a[i].ename+'?fr=sidebar" title="'+a[i].name+'">'+a[i].name+"</a></li>";$(".sb-content .node-list ul").html(t)}},class:".node-list"},"/friend/links":{func:function(a){if(a.ok){if(null==(a=a.data))return;var t="";for(var i in a)t+='<li style="margin-left:15px; margin-bottom:5px;"><a href="'+a[i].url+'" target="_blank" title="'+a[i].name+'">'+a[i].name+"</a></li>";$(".sb-content .friendslink-list ul").html(t)}},class:".friendslink-list"},"/rank/view":{func:function(a,t){if(a.ok){data=a.data;var i=data.list,e="";for(var s in i){var n=data.path+i[s].id,r=i[s].title;switch(data.objtype){case 0:n=data.path+i[s].tid;break;case 4:r=i[s].category+i[s].name,""!=i[s].uri&&(n=data.path+i[s].uri);break;case 5:r=i[s].name}r=o(r);var l=parseInt(s,10)+1,c="";c=l<4?'<img src="'+cdnDomain+"static/img/rank_medal"+l+'.png" width="20px">':"<em>"+l+"</em>",e+="<li>"+c+'<a href="'+n+'?fr=sidebar" title="'+r+'">'+r+"</a> - "+i[s].rank_view+" 阅读</li>"}$(".sb-content .rank-list").each(function(a){$(this).data("objtype")==data.objtype&&$(this).data("rank_type")==data.rank_type&&$(this).children().html(e)})}},class:".rank-list",data_keys:["objtype","rank_type"]}};if(void 0!==SG.SIDE_BARS)for(var s in SG.SIDE_BARS)if(void 0!==a[SG.SIDE_BARS[s]]){var n=a[SG.SIDE_BARS[s]],i=$(".sidebar .sb-content "+n.class);if(0==i.length)continue;if(!n.data_keys){var e=i.data("limit");""==e&&(e=10),$.ajax({type:"get",url:SG.SIDE_BARS[s],data:{limit:e},dataType:"json",success:n.func,ifModified:!0});continue}i.each(function(a){var t={limit:$(this).data("limit")};for(var i in n.data_keys){var e=n.data_keys[i];t[e]=$(this).data(e)}$.ajax({type:"get",url:SG.SIDE_BARS[s],data:t,dataType:"json",success:n.func,ifModified:!0})})}});